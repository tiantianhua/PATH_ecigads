********************************************************************************
*REGRESSION ANALYSIS 
*written by TIANZE SUN
*date: 17 March 2023
*************************regression*analysis************************************
*specify location
cd "\Users\s4476505\Dropbox\2022 PhD\5_PATH\Stata Files\Prevalence"

* Load combined, imputed dataset
use "22032023 imputed.dta", clear

*Set confidence interval to 99.17%
set level 99.17

* set survey weights
mi svyset VARPSU [pweight=R05_Y_AX04WGT], strata(VARSTRAT)
mi svyset [pweight= R05_Y_S04WGT]
********************************************************************************
********************************************************************************
*LIFETIME E-CIGARETTE USE (W5)
*Keep only never e-cigarette users at W4 & W4.5
tab X04R_Y_EVR_EPRODS, m
keep if X04R_Y_EVR_EPRODS == 0

*UNADJUSTED LOGISTIC REGRESSION
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_02, or
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_03, or 
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_04, or 
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_05, or 
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_06, or 
*mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_07, or
*mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_08, or
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_09, or

*ADJUSTED LOGISTIC REGRESSION, CONTROLLING FOR COVARIATES (W4)
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
R04_PN0337_01 R04_PN0335_01 R04_YX0680 R04_YX0681 ///
R04_PT0019 R04R_Y_AGECAT2 R04R_Y_PM0001 R04R_Y_PM0130 R04_YX0673 R04_YX0675 race Sex, or

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5)
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 X04_YX0681 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex, or

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5) without adjusting for peer-ecig use
mi estimate: svy: logit R05R_Y_EVR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex, or
********************************************************************************
*PAST 12-MONTH E-CIGARETTE USE (W5)
*UNADJUSTED LOGISTIC REGRESSION
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_02, or
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_03, or 
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_04, or 
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_05, or 
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_06, or 
*mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_07, or
*mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_08, or
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_09, or

*ADJUSTED LOGISTIC REGRESSION, CONTROLLING FOR COVARIATES (W4)
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
R04_PN0337_01 R04_PN0335_01 R04_YX0680 R04_YX0681 ///
R04_PT0019 R04R_Y_AGECAT2 R04R_Y_PM0001 R04R_Y_PM0130 R04_YX0673 R04_YX0675 race Sex, or

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5)
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 X04_YX0681 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex, or

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5) without adjusting for peer-ecig use
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex, or
********************************************************************************
*PAST 30-DAY E-CIGARETTE USE (W5)
*UNADJUSTED LOGISTIC REGRESSION
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_02, or
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_03, or 
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_04, or 
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_05, or 
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_06, or 
*mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_07, or
*mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_08, or
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_09, or

*ADJUSTED LOGISTIC REGRESSION, CONTROLLING FOR COVARIATES (W4)
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
R04_PN0337_01 R04_PN0335_01 R04_YX0680 R04_YX0681 ///
R04_PT0019 R04R_Y_AGECAT2 R04R_Y_PM0001 R04R_Y_PM0130 R04_YX0673 R04_YX0675 race Sex, or

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5)
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 X04_YX0681 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5) without adjusting for peer-ecig use
mi estimate: svy: logit R05R_Y_CUR_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex

*SENSITIVITY ANALYSES, CONTROLLING FOR COVARIATES (W4.5) without adjusting for peer-ecig use
mi estimate: svy: logit R05R_Y_P12M_EPRODS X04_YX0203_02 ///
X04_YX0203_03 X04_YX0203_04 X04_YX0203_05 X04_YX0203_06 X04_YX0203_09 ///
X04_PN0337_01 X04_PN0335_01 X04_YX0680 ///
X04_PT0019 X04R_Y_AGECAT2 X04R_P_PARSP_EDUC X04R_Y_PM0130 X04_YX0673 X04_YX0675 race Sex
********************************************************************************
